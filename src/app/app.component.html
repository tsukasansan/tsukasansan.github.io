<div class="app-body app-body--background">

    <div [hidden]="isAppLoaded"
         class="app-loading">
        <div class="logo"></div>
        <h1 class="color-loop">loading</h1>

        <span [ngClass]="{'show': retryConnect > 0}">
            {{retryConnect}}<br>
            attempts to connect
        </span>
        <span [ngClass]="{'show': retryConnect > 5}">
            Please check if META MASK is working or your GETH node was started with these options:<br>
            <i>./geth --testnet --fast --rpc --rpcapi db,eth,net,web3,personal --rpccorsdomain="*"</i>
        </span>
        <span [ngClass]="{'show': retryConnect > 10}">
            You may refresh this page and check again GETH and METAMASK
        </span>
        <span [ngClass]="{'show': retryConnect > 15}">
            Don't dive up.. this will connect :D
        </span>
    </div>

    <div [ngClass]="{'is-loaded': isWeb3Connected}"
         class="app-content">

        <header>
            <h1 class="logo-pic">
                E-LOTHERY <i>alpha</i>
            </h1>
            <app-connection-status></app-connection-status>
        </header>

        <div class="dashboard">
            <h1>
                Pick a lottery to play <a (click)="refreshList()">refresh list</a>
            </h1>

            <app-play *ngIf="isPlay" class="play" [play]="playContract"></app-play>

            <ul [ngClass]="{'is-loaded': !isLoading}"
                class="lottery-list">
                <li *ngFor="let contract of contracts">
                    <a [ngClass]="{'open': contract.contractData?.open}">
                        <h1>Jackpot: <span
                                [innerHtml]="(contract.contractData?.jackpot - (contract.contractData?.jackpot*(contract.contractData?.ownerFee/100)))/1000000000000000000"></span>
                            ETH
                        </h1>
                        <h1>Total: <span [innerHtml]="contract.contractData?.total/1000000000000000000"></span> / <span
                                [innerHtml]="contract.contractData?.jackpot/1000000000000000000"></span>ETH</h1>
                        <h1>Fee: <span [innerHtml]="contract.contractData?.fee/1000000000000000000"></span> ETH</h1>
                        <h1>Owner fee: <span [innerHtml]="contract.contractData?.ownerFee"></span> %</h1>
                        <h1>Result: <span [innerHtml]="contract.contractData?.result"></span></h1>
                        <h1>Open: <span [innerHtml]="contract.contractData?.open"></span></h1>
                        <!--<span *ngFor="let event of contract?.contractEvents">-->
                        <!--blockHash: {{event.blockHash}}<br>-->
                        <!--blockNumber: {{event.blockNumber}}<br>-->
                        <!--event: {{event.event}}<br>-->
                        <!--transactionHash: {{event.transactionHash}}<br>-->
                        <!--</span>-->
                        <button (click)="play(contract.contractData?.address)">play</button>
                        <ul>
                            <li *ngFor="let bets of contract.contractBets">
                                {{bets.address}}
                            </li>
                        </ul>
                    </a>
                </li>
            </ul>
        </div>
    </div>

</div>


<!--<button (click)="getAccounts()">bet contracts</button>-->
